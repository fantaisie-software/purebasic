;
;     Vehicle library documentation
;
;    Fantaisie Software
;

@Library Vehicle

@Overview

  Les véhicules (vehicle) sont habituellement composés d'un seul corps et d'une ou 
  de plusieurs roues (voitures, camions, vélos, etc.). Le nouveau véhicule créé est une simple 
  @LibraryLink "entity" "entité", de sorte que toutes les fonctions concernant les 
  entités peuvent être utilisées pour le manipuler.
@LineBreak
@LineBreak
  @@InitEngine3D doit être appelé avec succès avant d'utiliser les fonctions de cette 
  bibliothèque.

@CommandList

@ExampleFile All Vehicle.pb

@SupportedOS

;--------------------------------------------------------------------------------------------------------

@Function AddVehicleWheel(#Entity, #EntityRoue, TeteSuspensionX.f, TeteSuspensionY.f, TeteSuspensionZ.f, MoyeuRoueX.f, MoyeuRoueY.f, MoyeuRoueZ.f, DebattementMaxSuspension.f, RayonRoue.f, TractionRoue, RoulisRoue.f)

@Description
  Ajoute une nouvelle roue à un véhicule précédemment créé avec @@CreateVehicle.

@Parameter "#Entity"
  L'entité véhicule à utiliser.

@Parameter "#EntityRoue"
  L'entité à utiliser pour la roue.

@Parameter "TeteSuspensionX.f, TeteSuspensionY.f, TeteSuspensionZ.f"
  Coordonnées du point d'attache de la suspension sur le chassis.
  
@Parameter "MoyeuRoueX.f, MoyeuRoueY.f, MoyeuRoueZ.f"
  Coordonnée de l'axe de roue (moyeu).
  
@Parameter "DebattementMaxSuspension.f"
  Le débattement maximum de la suspension, en mètres.

@Parameter "RayonRoue.f"
  Le rayon de la roue.
  
@Parameter "TractionRoue"
@FixedFont
  @#True : La roue est motrice, @@ApplyVehicleForce et @@ApplyVehicleSteering s'appliquent à cette roue.
  @#False: La roue est libre, non motrice.
@EndFixedFont

@Parameter "RoulisRoue"
  Réduit le roulis de la roue (0.0: pas de roulis, 1.0: comportement physique).
  @LineBreak 
  @LineBreak
  Si le frottement est trop élevé, il pourrait être nécessaire de réduire cette valeur 
  pour arrêter le balancement du véhicule (Equivalent au réglage de la barre de torsion 
  dans le monde réel).

@NoReturnValue

@SeeAlso @@ApplyVehicleBrake, @@ApplyVehicleForce, @@CreateVehicle

@SupportedOS

;--------------------------------------------------------------------------------------------------------

@Function ApplyVehicleForce(#Entity, Roue, Force.f)

@Description
  Applique une force de traction sur une roue du véhicule. 

@Parameter "#Entity"
  L'entité véhicule à utiliser.

@Parameter "Roue"
  L'indice de la roue, à partir de 0.

@Parameter "Force"
  La force de traction à appliquer sur la roue.

@NoReturnValue
  
@Remarks  
  La nouvelle valeur de la force de traction remplace la force précédemment 
  appliquée à la roue du véhicule.
  
@SeeAlso @@ApplyVehicleSteering, @@ApplyVehicleBrake, @@AddVehicleWheel

@SupportedOS

;--------------------------------------------------------------------------------------------------------

@Function ApplyVehicleBrake(#Entity, Roue, Frein.f)

@Description
  Applique une force de freinage sur une roue du véhicule. 

@Parameter "#Entity"
  L'entité véhicule à utiliser.

@Parameter "Roue"
  L'indice de la roue, à partir de 0.

@Parameter "Frein"
  La force de freinage à appliquer sur la roue.

@NoReturnValue
  
@Remarks  
  La nouvelle valeur de la force de freinage remplace la force précédemment 
  appliquée à la roue du véhicule.

@SeeAlso @@ApplyVehicleSteering, @@ApplyVehicleForce, @@AddVehicleWheel

@SupportedOS

;--------------------------------------------------------------------------------------------------------

@Function ApplyVehicleSteering(#Entity, Roue, Braquage.f)

@Description
  Applique une force directive sur une roue du véhicule. 

@Parameter "#Entity"
  L'entité véhicule à utiliser.

@Parameter "Roue"
  L'indice de la roue, à partir de 0.

@Parameter "Braquage"
  La force directive à appliquer sur la roue.

@NoReturnValue
  
@Remarks  
  La nouvelle valeur de la force directive remplace la force précédemment 
  appliquée à la roue du véhicule.

@SeeAlso @@ApplyVehicleBrake, @@ApplyVehicleForce, @@AddVehicleWheel

@SupportedOS

;--------------------------------------------------------------------------------------------------------

@Function Resultat = CreateVehicle(#Entity)

@Description
  Crée une nouvelle entité véhicule.
  
@Parameter "#Entity" 
  Le numéro d'identification la nouvelle entité. 
@LineBreak
@LineBreak 
  @ReferenceLink "purebasic_objects" "#PB_Any" peut être 
  utilisé pour générer automatiquement ce numéro.

@ReturnValue
  Renvoie zéro si l'entité véhicule ne peut pas être créée. 
@LineBreak
@LineBreak 
  Si @ReferenceLink "purebasic_objects" "#PB_Any"   
  est utilisé comme paramètre '#Entity', le nouveau numéro d'entité
  de véhicule est renvoyé.

@SeeAlso
  @@FreeEntity

@SupportedOS

;--------------------------------------------------------------------------------------------------------

@Function CreateVehicleBody(#Entity, Masse.f, Restitution.f, Friction.f [, SuspensionRigidité.f, SuspensionCompression.f, SuspensionAmortissement.f, SuspensionCompressionMax.f, AdherencePneu.f)

@Description
  Crée un corps physique associé à une entité véhicule.
  
@Parameter "Masse"
  Masse du véhicule.
  @LineBreak
  @LineBreak
  Ne pas utiliser une trop grande valeur car il pourrait se produire des incohérences 
  physiques (1 est la valeur préférée). 
 
@Parameter "Restitution"
  Restitution du véhicule.
  @LineBreak
  @LineBreak
  Cette valeur peut également être obtenue ou configurer via @@GetEntityAttribute et @@SetEntityAttribute

@Parameter "Friction"
  Friction du véhicule. 
  @LineBreak
  @LineBreak
  Cette valeur peut également être obtenue ou configurer via @@GetEntityAttribute et @@SetEntityAttribute

@OptionalParameter "SuspensionRigidité"
  La rigidité de la suspension (10: Buggy tout terrain, 50: Voiture de sports, 200: Voiture F1)

@OptionalParameter "SuspensionCompression"
  Le coefficient d'amortissement à utiliser lorsque la suspension est comprimée. 
  @LineBreak
  @LineBreak  
  Mettre à valeur * 2 * RacineCarrée(SuspensionRigidité), elle est donc proportionnelle 
  à l'amortissement critique. 
  @LineBreak
  @LineBreak
  Exemples de valeur:
@FixedFont
  valeur = 0: non amortie et bondissant
  valeur = 1: amortissement critique
@EndFixedFont
  Les valeurs recommandées vont de 0.1 à 0.3.

@OptionalParameter "SuspensionAmortissement"
  L'amortissement lorsque la suspension est totallement étirée.
  @LineBreak
  @LineBreak
  Voir SuspensionCompression pour définir cette valeur.  @LineBreak 
  La valeur de SuspensionAmortissement doit être légèrement plus grande que 
  SuspensionCompression. 
    @LineBreak
  @LineBreak
  Les valeurs recommandées vont de 0.2 à 0.5. 
  
@OptionalParameter "SuspensionCompressionMax"
  La longueur à laquelle la suspension peut être comprimée (en centimètres).

@OptionalParameter "AdherencePneu"
  Le frottement entre le pneumatique et le sol. 
  @LineBreak
  @LineBreak 
  Devrait être d'environ 0,8 pour les voitures réalistes mais peut augmenter 
  pour une meilleure manipulation.@LineBreak 
  Une grande valeur (10000.0) peut être utilisé pour les karts.

@NoReturnValue

@Remarks
  Pour que les collisions  soient gérées par le moteur physique, 
  l'entité doit avoir un corps (body).@LineBreak
  En fait, seul le corps est connu par le moteur physique qui fera tout le calcul 
  sur l'entité, vérifier la masse, la friction et s'il entre en collision.
@LineBreak
@LineBreak
  Pour avoir un effet, le moteur physique doit être activé avec @@EnableWorldPhysics.
  

@SeeAlso
  @@FreeEntityBody

@SupportedOS

;--------------------------------------------------------------------------------------------------------

@Function Resultat.f = GetVehicleAttribute(#Entity, Attribut, Roue)

@Description
  Obtenir l'attribut spécifié d'une entité véhicule.

@Parameter "#Entity"
  L'entité véhicule à utiliser.

@Parameter "Attribut"
  L'attribut à obtenir. Les attributs suivants sont disponibles:
@FixedFont
  @#PB_Vehicle_Friction                : La valeur de frottement de la roue (voir @@CreateVehicleBody pour plus d'info).
  @#PB_Vehicle_MaxSuspensionForce      : La valeur de la force maximale de la suspension de roue (voir @@CreateVehicleBody pour plus d'info).
  @#PB_Vehicle_SuspensionStiffness     : La valeur de rigidité de la suspension (voir @@CreateVehicleBody pour plus d'info).
  @#PB_Vehicle_MaxSuspensionCompression: La valeur de compression maximale de la suspension de roue (voir @@CreateVehicleBody pour plus d'info).
  @#PB_Vehicle_MaxSuspensionLength     : La longueur maximale de la suspension (mètres).
  @#PB_Vehicle_WheelDampingCompression : La valeur de compression d'amortissement de la roue.
  @#PB_Vehicle_WheelDampingRelaxation  : La valeur de détente d'amortissement de la roue.
  @#PB_Vehicle_RollInfluence           : La valeur de l'influence du roulis de la roue (voir @@AddVehicleWheel pour plus d'info).
  @#PB_Vehicle_IsInContact             : Renvoie @#True si le véhicule est en contact avec un autre objet, @#False sinon.
  @#PB_Vehicle_CurrentSpeed            : La vitesse actuelle du véhicule en km/heure.
  @#PB_Vehicle_ContactPointX           : La coordonnée X du point de contact.
  @#PB_Vehicle_ContactPointY           : La coordonnée Y du point de contact.
  @#PB_Vehicle_ContactPointZ           : La coordonnée Z du point de contact.
  @#PB_Vehicle_ContactPointNormalX     : La valeur normale X du point de contact.
  @#PB_Vehicle_ContactPointNormalY     : La valeur normale Y du point de contact.
  @#PB_Vehicle_ContactPointNormalZ     : La valeur normale Z du point de contact.
  @#PB_Vehicle_ForwardVectorX          : La valeur X du vecteur du point de contact.
  @#PB_Vehicle_ForwardVectorY          : La valeur Y du vecteur du point de contact.
  @#PB_Vehicle_ForwardVectorZ          : La valeur Z du vecteur du point de contact.

@EndFixedFont

@Parameter "Roue"
  L'indice de la roue, à partir de 0.
  @LineBreak
  @LineBreak  
  Si non spécifié, ou mis à @#PB_All, la nouvelle valeur de l'attribut est appliquée 
  à toutes les roues.

@ReturnValue
  Renvoie la valeur de l'attribut spécifié ou 0 si le véhicule ne supporte pas l'attribut.

@SeeAlso
  @@SetVehicleAttribute

@SupportedOS

;--------------------------------------------------------------------------------------------------------

@Function SetVehicleAttribute(#Entity, Attribut, Valeur.f [, Roue])

@Description
  Définir la valeur de l'attribut spécifié d'une entité véhicule.

@Parameter "#Entity"
  L'entité véhicule à utiliser.

@Parameter "Attribut"
  L'attribut à définir. Les attributs suivants sont disponibles:
@FixedFont
  @#PB_Vehicle_Friction                : La valeur de frottement de la roue (voir @@CreateVehicleBody pour plus d'info).
  @#PB_Vehicle_MaxSuspensionForce      : La valeur de la force maximale de la suspension de roue (voir @@CreateVehicleBody pour plus d'info).
  @#PB_Vehicle_SuspensionStiffness     : La valeur de rigidité de la suspension (voir @@CreateVehicleBody pour plus d'info).
  @#PB_Vehicle_MaxSuspensionCompression: La valeur de compression maximale de la suspension de roue (voir @@CreateVehicleBody pour plus d'info).
  @#PB_Vehicle_MaxSuspensionLength     : La longueur maximale de la suspension (mètres).
  @#PB_Vehicle_WheelDampingCompression : La valeur de compression d'amortissement de la roue.
  @#PB_Vehicle_WheelDampingRelaxation  : La valeur de détente d'amortissement de la roue .
  @#PB_Vehicle_RollInfluence           : La valeur de l'influence du roulis de la roue (voir @@AddVehicleWheel pour plus d'info).
@EndFixedFont

@Parameter "Valeur.f"
  Valeur de l'attribut.
  
@OptionalParameter "Roue"
  L'indice de la roue, à partir de 0.
  @LineBreak
  @LineBreak  
  Si non spécifié, ou mis à @#PB_All, la nouvelle valeur de l'attribut est appliquée 
  à toutes les roues.

@NoReturnValue

@SeeAlso
  @@GetVehicleAttribute

@SupportedOS

